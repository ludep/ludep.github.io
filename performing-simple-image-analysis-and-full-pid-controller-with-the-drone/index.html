
<!DOCTYPE html>
<html lang="en-US">
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> -->

<!-- Mirrored from www.ludep.com/performing-simple-image-analysis-and-full-pid-controller-with-the-drone/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 15 Mar 2021 00:49:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>

	<meta charset="UTF-8" />
	<title>Performing simple image analysis and full PID controller with the Drone | LUDEP</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<meta name="description" content=" more" />	<meta name="keywords" content=" more, Drone, Issues, Programming, Testing" />

	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="../feed/atom/index.html" />
	<link rel="pingback" href="../xmlrpc.php" />

	<style type="text/css">/* no_sidebars.css */ div#wrapper { width:100%; }  body { font-size:12px; font-family:Verdana, Geneva, sans-serif; font-weight:normal; color:#505050; background-color:#ffffff; }  /* LAYOUT */ #container { margin: 0 auto; width: 990px; min-width:600px; background-color:#ffffff; } #wrapper { background-color:#ffffff; padding-top:10px; } #content { padding:0 15px 10px 15px; }  .sidebar .column { margin:19px  0 10px 0;}  .sidebar > :first-child h5 { margin-top:0; } #outer-footer { padding-top: 10px } #footer { border-bottom: 4px solid #27a5c4; border-top: 2px solid #27a5c4; background-color: #b7dee8; }  #header { color: #27a5c4; font-family:Georgia, serif; background-color:#ffffff; margin: 0; padding: 0; margin: 0; } #masthead { margin: 0px 0px 0px 10px; padding-left:0px; } #header h1, #header h3 { font-size:64px; margin:0; font-weight:normal; letter-spacing: -2px; padding:10px 0 0 0; } #header a.blankheader { display:block; height: 64px; width:300px; } #header a { text-decoration:none; color: #27a5c4; border-bottom:none; } #header .description { font-family:Georgia, serif; font-size:18px; font-weight:normal; font-style:italic; margin-top: -0.25em; padding-bottom: 5px; }  #header a.subscribe-button  {  display:block; float:right; margin-top:-20px; } #header a.subscribe-button:hover {  margin-top:-10px; } /* NAVIGATION */ /* =Menu -------------------------------------------------------------- */  #access { /*background: #000;*/ margin: 0 auto; width: 100%; display:block; float:left; /*padding: 1px 0 1px 8px;*/ border-top: 4px solid #27a5c4; border-bottom: 2px solid #27a5c4; background-color: #b7dee8; } #access .menu-header, div.menu { font-size: 13px; margin-left: 12px; } #access .menu-header ul, div.menu ul { list-style: none; margin: 0; } #access .menu-header li, div.menu li { float:left; position: relative; margin: 0; } #access a { display:block; text-decoration:none; padding:0 10px; line-height:38px; color: #707070;  font-family:Trebuchet MS, Helvetica, sans-serif; font-size:18px; font-weight:normal;   } #access ul ul { display:none; position:absolute; top:38px; left:0; float:left; z-index: 99999; border-left:  1px solid #27a5c4; border-right: 1px solid #27a5c4; border-bottom:1px solid #27a5c4; background-color: #b7dee8; } #access ul ul ul { left:100%; top:1px; border-top:1px solid #27a5c4;  } #access ul ul a { font-family:Trebuchet MS, Helvetica, sans-serif; font-size:13px; font-weight:normal; } #access ul ul a { /*background:#333;*/ height:auto; line-height:1em; padding:10px; width: 170px; } #access li:hover > a, #access ul ul :hover > a { color:#000000; /*background:#333;*/  } #access ul li:hover > ul { display:block; }  /* menu-item menu-item-type-post_type current-menu-ancestor current-menu-parent current_page_parent current_page_ancestor menu-item menu-item-type-post_type current-menu-item page_item page-item-155 current_page_item */  #access .current-menu-item, #access .current_page, #access .current_page_item, #access .current_page_item a, #access .current-menu-ancestor, #access .current_page_ancestor { color: #505050; background-color: #8bd6e0; }  div.post-list-column { float:left; width:50%; } div.post-list-column .margins { padding: 0 10px 15px 10px; } .post-list-column .storycontent, .post-list-column .content { padding:0 0 0 4px; } .post-thumbnail, .regular-post-thumbnail { border: 1px solid #eeeeee; padding:3px; }  .regular-post-thumbnail { float:left; width: 100px; margin:18px 5px 10px 10px; } .wp-post-image { max-width:100%; border: none; }  div.post-list-column .wp-post-image { display:block; }  #postpath, #postpath a { font-family:Trebuchet MS, Helvetica, sans-serif; font-size:13px; font-weight:normal; color:#707070; }  /* LINKS */  a { color:#a17244; text-decoration:underline; } .post a:visited { color: #756455; text-decoration:underline; } .post a:hover { color: #de8435; text-decoration:underline; } .post h1 a:hover,  .post h2 a:hover { border-bottom:none; text-decoration:none; }  /* HEADINGS */  h1,h2,h3, h4, h5, h6 { color: #505050; margin-top:5px; font-family:Georgia, serif; font-weight: normal; } h1, h2.h1 { font-size:36px; font-weight: normal; margin:0px 0 3px 0; padding:10px 0 0 5px; color: #505050; overflow:hidden; } .post-list-column h2 { font-size: 24px; font-weight: normal; margin:0px 0 0px 0; padding:3px 0 0px 4px; color: #505050; } h2 { /*font-size:24px;*/ margin:5px 0 2px 0; color: #505050; font-size:24px; font-weight: normal; font-family:Georgia, serif; } h3 { margin:5px 0 0px 0; font-size:18px; font-weight: normal; font-family:Georgia, serif; } .post h3 { color: #98293D; } h4 { font-size:13px; font-weight: bold; font-family:Verdana, Geneva, sans-serif; } h1 a, h2.h1 a, h1 a:visited, h2.h1 a:visited, .post h1 a, .post h2.h1 a, .post h1 a:visited, .post h2.h1 a:visited, .post-list-column h2 a, .post-list-column h2 a:visited { color: #505050; border-bottom: none; text-decoration:none; } h1 a:hover, h2.h1 a:hover, h1 a:visited:hover, h2.h1 a:visited:hover, .post h1 a:hover, .post h2.h1 a:hover, .post h1 a:visited:hover, .post h2.h1 a:visited:hover, .post-list-column h2 a:hover, .post-list-column h2 a:visited:hover { color: #000000; border-bottom: none; text-decoration:none; } h1.page-title { font-size:18px; } h1.page-title span { color: #27a5c4; } /* POST */ div.post { overflow:hidden; } table.info { padding:0; margin:0; border-collapse:collapse; } table.info td,  table.info th { padding:0; margin:0; font-weight:normal; } pre { border:1px dotted #cccccc;; margin:5px 0; padding:10px 10px 10px 20px; background-color:#fbfbfb; } blockquote{ /*background:#f2f2f2 url(img/blockquote.gif) 3px 3px no-repeat;*/ border:1px dotted #cccccc; padding:10px 10px 10px 20px; margin:5px 0 5px 20px; background-color:#fbfbfb; } code { background-color:#fbfbfb; font-family: Courier New, Courier, monospace; border:1px dotted #cccccc; } .post .storycontent, .post .content { padding:5px 10px 5px 10px; overflow:hidden; line-height: 1.5; }  .post .info { padding:3px 0px 3px 0px; margin: 2px 0 2px 0; border-top: 1px solid #eeeeee; }  .post .date { background-position:0 -48px; color: #707070; padding:0 0px; } .post .info  .postedby, .post .info  .filledunder { color: #bbb; } .post .info  .postedby  a, .post .info  .filledunder a { color: #707070; text-decoration:none; } .post .info  .postedby a:hover, .post .info  .filledunder a:hover { color: #000000; text-decoration:none; } .post .info td { border: none; padding: 0 5px; } .post table.info { width:100%; } .post .info .act { white-space: nowrap; text-align:right; } .post table.info .date { width:1%; white-space: nowrap; } .post .act span { padding-left:15px; } .post .info * { font-family: Verdana, Geneva, sans-serif; line-height:16px; font-size:10px; overflow:hidden; } hr { border: 0px none; background-color: #eeeeee; color: #eeeeee; height:2px; } fieldset{ border: 1px solid #eeeeee; padding:5px 10px 5px 10px; } legend { padding: 0px 5px 1px 5px; border: 1px solid #eeeeee; } input.text, input.textbox, input.password, input.file, textarea, input[type=text], input[type=password],input[type=file], select { border:1px solid #bbbbbb; background-color:#ffffff; padding:2px; color: #505050;  } input.text:focus, input.textbox:focus, input.password:focus, input.file:focus, textarea:focus, input[type=text]:focus, input[type=password]:focus,input[type=file]:focus, select { border:1px solid #505050; }  .post table { border-collapse:collapse; border: none; } .post  th, .post  td { border-bottom:1px solid #eeeeee; border-left:none; border-right:none; padding:2px 10px; text-align:left; vertical-align:top;  font-size: 90%;  font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif;  } .post tr.even td { background-color: #b7dee8; } .post th  { background-color: #b7dee8; border-bottom: 1px solid #27a5c4; border-top: 2px solid #27a5c4; color: #707070; } #author-avatar { float:left; width: 100px; margin:7px 15px 7px 10px; }  /* comment START */ /* COMMENTS */ #comments > ol {list-style-type: none;line-height: 18px;margin: 0px;padding: 0px 0px 10px 10px; text-align: justify;} #comments ul li {list-style-type: none;list-style-image: none;list-style-position: outside;margin: 0 0 0 5px; padding: 5px 0 0 0;} .commentlist li {margin: 15px 0 10px;padding: 2px 2px 5px 2px;list-style: none;} .commentlist li > ul > li {background:none;list-style:none;margin:3px 0 3px 20px;padding:3px 0;} .commentlist li .avatar {border:none; margin:0;padding:1px 8px 1px 1px; width: 26px;float:left; background:none;} .commentlist .fn { font-size: 14px;  font-weight: bold; font-style: normal; padding:4px 2px 2px 2px;  font-family: Verdana, Geneva, sans-serif; } .commentlist .fn > a  { font-weight:bold; font-style: normal; text-decoration:none; } .commentlist .fn a:hover {/*text-decoration:underline;*/} .commentmetadata  { /*color:#723419;*/ font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif; font-size:11px;  margin:0 0 0px 20px; text-decoration: none; }  .commentmetadata a  { font-weight: normal; text-decoration: none; color: #707070; }   .vcard a.url{ color: #707070; /*#723419;*/ text-decoration: none; } .vcard a.url:hover{ color: #000000; /*#723419;*/ text-decoration: none; }  .bypostauthor >.vcard div.fn >a { color:#98293D; } .bypostauthor >.vcard div.fn >a:hover { color:#000000; } .bypostauthor>div { color:#98293D; } /*  Uncomment following text to assign specific color to admin (or to any other user) You may need to change user name here E.g.  comment-author-MyUserName instead of  comment-author-admin */ /* .comment-author-admin>*, .comment-author-admin >.vcard div.fn >a { color:#106000; }*/ .comment { color:#505050; } .commentmetadata a, .commentmetadata a:visited {color: #707070;} .commentmetadata a:hover{ color: #000000;} #comments .children { padding: 0 0 0 20px; } .thread-alt {background-color:transparent} .thread-even {background-color: transparent;} .depth-1  { border: 1px solid #27a5c4; } .depth-2, .depth-3{/*border-top: 1px solid #dac2a3;*/} .even, .alt {} .vcard { background-color:#b7dee8;} .depth-2 .vcard, .depth-3 .vcard, .depth-4 .vcard, .depth-5 .vcard, .depth-6 .vcard, .depth-7 .vcard, .depth-8 .vcard { border-top: 1px dotted #27a5c4; border-bottom: 1px dotted #27a5c4; } .reply {margin: 0px 0px 0px 10px;} .comment-reply-link { background-color:#b7dee8;color: #707070; padding: 1px 4px; font-size:12px; text-decoration: none; border: 1px dotted #27a5c4; } .comment-reply-link:hover { color: #000000; text-decoration: none; }   #comments .comment-body ul li { list-style:square; margin: 0 0 0 30px; padding:0; } #comments .comment-body ol  { margin: 0; padding: 0; } #comments .comment-body ol li { list-style-type:decimal; padding:0; margin: 0 0 0 30px; display: list-item; } .comment-body { padding:2px 2px 2px 10px; }  /************************** IMAGES *************************************/  .post img.wp-caption, .wp-caption, .gallery-caption { -moz-border-radius: 3px; /* Firefox */ -webkit-border-radius: 3px; /* Safari, Chrome */ -khtml-border-radius: 3px; /* KHTML */ border-radius: 3px; /* CSS3 */    border:1px solid #eeeeee; display:block; height:auto; margin-bottom:10px; padding-top:4px; text-align:center; max-width:100%; } .regular-post-thumbnail img.attachment-post-thumbnail { display:block; margin: auto; } .post img.wp-caption{ padding:4px; } .post .wp-caption img, .wp-caption img { border:0 none !important; margin:0 !important; padding:0 !important; max-width:99.5%; } .post img { border:none; padding:0px; vertical-align:bottom; height:auto; max-width:100%; } a.wp-caption { color: #505050; text-decoration:none; } a.wp-caption p,a.wp-caption:hover p, .wp-caption p.wp-caption-text, .full-image-caption { color:#505050; font-size:11px; font-family:Verdana, Geneva, sans-serif; line-height:12px; margin:0; padding:2px 4px 4px; } a.wp-caption:hover { border:1px solid /*#dac2a3;*/#777777; background-color:#f2f2f2; }   /****************************************************************************************** SIDEBAR *******************************************************************************************/ #sidebar .subscribe-rss { padding:10px 0 0px 42px; height:30px; display:block; font-size:20px; font-family:Verdana,Geneva,sans-serif; margin:0 0 10px 0; }  #sidebar a.subscribe-rss:hover { color:#000000; text-decoration:none; } .sidebar { font-family:Georgia, serif; font-size:13px; }  .widget { margin-bottom:10px; line-height:1.5; overflow:hidden; } .textwidget { padding:10px 5px 10px 5px; border-bottom: 1px dotted #eeeeee; line-height:1.5; } .sidebar h5 { font-size:22px; font-family: Georgia, serif; font-weight:normal; border-bottom: 2px solid #eeeeee; padding: 5px 5px 10px 10px; } .sidebar a { color: #73b655;/*#64ae42;*/ font-size:13px; text-decoration:none; } .sidebar .widget_text a, .sidebar .widget_text a:hover { text-decoration:underline; } .sidebar a:hover { color: #000000; text-decoration:none; } .sidebar li { list-style:none; margin:0; padding: 7px 5px; } .sidebar .widget>ul>li, .sidebar ul.menu>li { border-bottom: 1px dotted #eeeeee; } .sidebar .widget>ul>li>.children, .sidebar .widget .sub-menu { padding-top:7px; } .sidebar li>ul li { padding: 7px 5px 7px 10px; } .sidebar li a { /*display: block;*/ } .sidebar .blogroll li { color:  #a0a0a0; font-size: 11px; } #wp-calendar table { border-collapse:collapse; border:0px solid #eeeeee; } #wp-calendar th,  #wp-calendar  td  { border:none; padding:0px 4px; vertical-align:top; font-family: Georgia, serif; font-size:90%; } #wp-calendar td { text-align:right; } #wp-calendar th  { background-color: #eeeeee; color:#ffffff; text-align:center; padding: 1px 4px 1px 4px; } #wp-calendar caption { font-family: Georgia, serif; font-weight:bold; /*color:#777777;*/ padding:10px 0 2px 0; }  #wp-calendar td#prev { text-align:left; } #wp-calendar td#next { text-align:right; } #wp-calendar #today  /*TODO!*/ { border: 1px dotted #dddddd; background-color: #b7dee8; }  /*Search widget*/  #searchform label  { display:block; } #s { width:110px; } #searchsubmit, .button, input#submit { border:1px solid #505050; color:#ffffff; font-weight:bold; font-family:Trebucht MS, Arial; text-shadow:0 -1px 0 rgba(0, 0, 0, 0.3); cursor: pointer; padding:1px 5px 1px 5px; background: #555555;  /* for non-css3 browsers */ filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#bbbbbb', endColorstr='#000000'); /* for IE */ background: -webkit-gradient(linear, left top, left bottom, from(#bbbbbb), to(#000000)); /* for webkit browsers */ background: -moz-linear-gradient(top,  #bbbbbb,  #000000); /* for firefox 3.6+ */ } #searchsubmit:hover, .button:hover { border:1px solid #000000; }  #searchsubmit:active, .button:active { cursor: pointer; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#505050', endColorstr='#777777'); /* for IE */ background: -webkit-gradient(linear, left top, left bottom, from(#505050), to(#777777)); /* for webkit browsers */ background: -moz-linear-gradient(top,  #505050,  #777777); /* for firefox 3.6+ */ } /* PAGINATION */  #comments a.page-numbers, #comments span.page-numbers { text-decoration: none; border: 1px solid #eeeeee; padding: 2px 5px; margin: 2px; color: #505050; }  #comments .navigation { margin: 10px 0; }  #comments .navigation a:hover { border: 1px solid #505050; background-color: #f7f7f7; color: #505050; text-decoration:none; } #comments span.page-numbers { font-weight: bold; color: #ffffff; background-color: #505050; border: 1px solid #505050; }  /* WP-PageNavi http://wordpress.org/extend/plugins/wp-pagenavi/ */  .wp-pagenavi { clear: both; }  .wp-pagenavi a, .wp-pagenavi span  { text-decoration: none; border: 1px solid #eeeeee; padding: 2px 5px; margin: 2px; color: #505050; }  .wp-pagenavi a:hover { border: 1px solid #505050; background-color: #f7f7f7; color: #505050; text-decoration:none; }  .wp-pagenavi span.current { font-weight: bold; color: #ffffff; background-color: #505050; border: 1px solid #505050; } .wp-pagenavi .extend { background:transparent;  border:0px none transparent;  color: #505050; margin-right:6px;  padding:0;  text-align:center;  text-decoration:none; }  /* used by PAGBEAR plugin for multipaged posts. http://wordpress.org/extend/plugins/pagebar/ */ .pagebar { padding:0; margin:4px 0; }  .pagebar a { background:transparent;  border: 1px solid #eeeeee; color: #505050; margin: 2px; padding:2px 5px; text-align:center; text-decoration:none; } .pageList .this-page  { font-weight: bold; color: #ffffff; background-color: #505050; border: 1px solid #505050; margin: 2px; padding:2px 5px; text-align:center; text-decoration:none; } .pagebar a:visited { color: #505050; text-decoration:none; }  .pagebar .break { background:transparent;  border:0px none transparent;  color: #505050; margin-right:6px;  padding:0;  text-align:center;  text-decoration:none; }  .pagebar .this-page { font-weight: bold; color: #ffffff; background-color: #505050; border: 1px solid #505050; margin: 2px; padding:2px 5px; text-align:center; text-decoration:none; }  .pagebar a:hover { border: 1px solid #505050; background-color: #f7f7f7; color: #505050; text-decoration:none; }  .pagebar .inactive { border: 1px solid #eeeeee; background-color: #ffffff; color: #cccccc; text-decoration: none; padding:2px 4px; }  #postnavi .prev a  { float:left; } #postnavi .next a { float:right; } #postnavi  a  { background:transparent;  border: 1px solid #eeeeee; color: #505050; margin: 2px; padding:2px 5px; text-align:center; text-decoration:none; } #postnavi a:hover { border: 1px solid #505050; background-color: #f7f7f7; color: #505050; text-decoration:none; } /* FOOTER */   .footer-column  { margin:0; padding:10px; line-height:1.5; }  #blue-footer { float:left; width: 100%; } #green-footer { float:left; width: 100%; } #orange-footer { float:left; width: 100%; } #red-footer { float:left; width: 100%; } #footer h5 { font-size:22px; font-family: Georgia, serif; font-weight:normal; border-bottom: 2px solid #eeeeee; padding: 5px 5px 10px 10px; } #footer  a { color: #73b655;/*#64ae42;*/ font-size:13px; text-decoration:none; } #footer  .widget_text a, #footer .widget_text a:hover { text-decoration:underline; } #footer  a:hover { color: #000000; text-decoration:none; } #footer  li { list-style:none; margin:0; padding: 7px 5px; } #footer .widget>ul>li, #footer  ul.menu>li { border-bottom: 1px dotted #eeeeee; } #footer  .widget>ul>li>.children, #footer  .widget .sub-menu { padding-top:7px; } #footer  li>ul li { padding: 7px 5px 7px 10px; } /*#footer li a { display: block; }*/   </style>	<link rel="stylesheet" href="../wp-content/themes/clear-line/style.css" type="text/css" media="screen" />

		<link rel='archives' title='August 2011' href='../2011/08/index.html' />
	<link rel='archives' title='July 2011' href='../2011/07/index.html' />
	<link rel='archives' title='June 2011' href='../2011/06/index.html' />
	<link rel='archives' title='May 2011' href='../2011/05/index.html' />
	<link rel='archives' title='April 2011' href='../2011/04/index.html' />
	<link rel='archives' title='March 2011' href='../2011/03/index.html' />
		                        <style type="text/css" media="screen" >
                                .socialwrap li.icon_text a img, .socialwrap li.iconOnly a img, .followwrap li.icon_text a img, .followwrap li.iconOnly a img{border-width:0 !important;background-color:none;}#follow.top {width:100%; position:fixed; left:0px; top:0px;}#follow.top ul {padding-left:20px;list-style-type:none;}#follow.top ul li {float:left;padding-top:4px;margin-right:10px;list-style-type:none;}#follow.top ul li.follow {color:#000;line-height:24px;}body {padding-top:32px}#follow a {text-decoration:none}
li.icon_text a span.head{}
li.icon_text a:hover span {border-bottom:solid 1px blue;}.share {margin:0 3px 3px 0;}
.phat span {display:inline;}
ul.row li {float:left;list-style-type:none;}
li.iconOnly a span.head {display:none}
#follow.left ul.size16 li.follow{margin:0px auto !important}
li.icon_text a {padding-left:0;margin-right:3px}
li.text_only a {background-image:none !important;padding-left:0;}
li.text_only a img {display:none;}
li.icon_text a span{background-image:none !important;padding-left:0 !important; }
li.iconOnly a span.head {display:none}
ul.socialwrap li {margin:0 3px 3px 0 !important;}
ul.socialwrap li a {text-decoration:none;}ul.row li {float:left;line-height:auto !important;}
ul.row li a img {padding:0}.size16 li a,.size24 li a,.size32 li a, .size48 li a, .size60 li a {display:block}ul.socialwrap {list-style-type:none !important;margin:0; padding:0;text-indent:0 !important;}
ul.socialwrap li {list-style-type:none !important;background-image:none;padding:0;list-style-image:none !important;}
ul.followwrap {list-style-type:none !important;margin:0; padding:0}
ul.followwrap li {margin-right:3px;margin-bottom:3px;list-style-type:none !important;}
#follow.right ul.followwrap li, #follow.left ul.followwrap li {margin-right:0px;margin-bottom:0px;}
.shareinpost {clear:both;padding-top:0px}.shareinpost ul.socialwrap {list-style-type:none !important;margin:0 !important; padding:0 !important}
.shareinpost ul.socialwrap li {padding-left:0 !important;background-image:none !important;margin-left:0 !important;list-style-type:none !important;text-indent:0 !important}
.socialwrap li.icon_text a img, .socialwrap li.iconOnly a img{border-width:0}ul.followrap li {list-style-type:none;list-style-image:none !important;}
div.clean {clear:left;}
div.display_none {display:none;}
                        </style>
                                                <style type="text/css" media="print" >
                                body {background: white;font-size: 12pt;color:black;}
 * {background-image:none;}
 #wrapper, #content {width: auto;margin: 0 5%;padding: 0;border: 0;float: none !important;color: black;background: transparent none;}
 a { text-decoration : underline; color : #0000ff; }
#menu, #navigation, #navi, .menu {display:none}
                        </style>
                        <link rel="image_src" href="../../www.gravatar.com/avatar/36c74ec929d95739677af607936df07e6418.png?default=&amp;size=110.jpg" />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="LUDEP &raquo; Feed" href="../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="LUDEP &raquo; Comments Feed" href="../comments/feed/index.html" />
<!-- This site is powered by Shareaholic - https://shareaholic.com -->
<script type='text/javascript' data-cfasync='false'>
  //<![CDATA[
    _SHR_SETTINGS = {"endpoints":{"local_recs_url":"http:\/\/www.ludep.com\/wp-admin\/admin-ajax.php?action=shareaholic_permalink_related"}};
  //]]>
</script>
<script type='text/javascript' data-cfasync='false'
        src='../../dsms0mj1bbhn4.cloudfront.net/assets/pub/shareaholic.js'
        data-shr-siteid='dfcda9e11023ab5708e53ad765e54924' async='async' >
</script>

<!-- Shareaholic Content Tags -->
<meta name='shareaholic:site_name' content='LUDEP' />
<meta name='shareaholic:language' content='en-US' />
<meta name='shareaholic:url' content='http://www.ludep.com/performing-simple-image-analysis-and-full-pid-controller-with-the-drone/' />
<meta name='shareaholic:keywords' content='drone, issues, programming, testing' />
<meta name='shareaholic:article_published_time' content='2011-06-10T19:07:42+00:00' />
<meta name='shareaholic:article_modified_time' content='2011-08-31T17:43:20+00:00' />
<meta name='shareaholic:shareable_page' content='true' />
<meta name='shareaholic:article_author_name' content='Michael' />
<meta name='shareaholic:site_id' content='dfcda9e11023ab5708e53ad765e54924' />
<meta name='shareaholic:wp_version' content='7.6.1.2' />
<meta name='shareaholic:image' content='../wp-content/uploads/2011/06/PID_variables_graph-1024x467.png' />
<!-- Shareaholic Content Tags End -->

<!-- Shareaholic Open Graph Tags -->
<meta property='og:image' content='../wp-content/uploads/2011/06/PID_variables_graph-1024x467.png' />
<!-- Shareaholic Open Graph Tags End -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.ludep.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.1.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../wp-includes/css/dist/block-library/style.min9738.css?ver=5.1.8' type='text/css' media='all' />
<link rel='stylesheet' id='wpt-twitter-feed-css'  href='../wp-content/plugins/wp-to-twitter/css/twitter-feed9738.css?ver=5.1.8' type='text/css' media='all' />
<!-- This site uses the Google Analytics by MonsterInsights plugin v5.5.4 - Universal enabled - https://www.monsterinsights.com/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-22499108-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by MonsterInsights -->
<script type='text/javascript' src='../wp-includes/js/jquery/jqueryb8ff.js?ver=1.12.4'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/ui/core.mine899.js?ver=1.11.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var social_connect_data = {"wordpress_enabled":""};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/plugins/social-connect/media/js/connect9738.js?ver=5.1.8'></script>
<link rel='https://api.w.org/' href='../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" />
<link rel='prev' title='Improving the omnidirectional robot design' href='../improving-the-omnidirectional-robot-design/index.html' />
<link rel='next' title='Some steps further with the omnidirectional robot' href='../some-steps-further-with-the-omnidirectional-robot/index.html' />

<link rel="canonical" href="index.html" />
<link rel='shortlink' href='../index0ced.html?p=586' />
<link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embeda663.json?url=http%3A%2F%2Fwww.ludep.com%2Fperforming-simple-image-analysis-and-full-pid-controller-with-the-drone%2F" />
<link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed039b?url=http%3A%2F%2Fwww.ludep.com%2Fperforming-simple-image-analysis-and-full-pid-controller-with-the-drone%2F&amp;format=xml" />
<meta property="og:type" content="article"/><meta property="og:url" content="http://www.ludep.com/performing-simple-image-analysis-and-full-pid-controller-with-the-drone/"/><meta property="og:title" content="Performing simple image analysis and full PID controller with the Drone"/><meta property="og:description" content="Michael | Drone, Issues, Programming, Testing"/><meta property="og:image" content="../wp-content/uploads/2011/06/PID_variables_graph-150x150.png"/><link rel="shortcut icon" href="../wp-content/plugins/multicons/images/favicon.ico" />



<link rel='stylesheet' id='social_connect-css'  href='../wp-content/plugins/social-connect/media/css/style9738.css?ver=5.1.8' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='../wp-includes/css/dashicons.min9738.css?ver=5.1.8' type='text/css' media='all' />
<link rel='stylesheet' id='wp-jquery-ui-dialog-css'  href='../wp-includes/css/jquery-ui-dialog.min9738.css?ver=5.1.8' type='text/css' media='all' />
		<style type="text/css">
						ol.footnotes li {list-style-type:decimal;}
						ol.footnotes{font-size:0.8em; color:#666666;}		</style>
		<link rel="Shortcut Icon" type="image/x-icon" href="../favicon.ico" />
</head>
<body class="post-template-default single single-post postid-586 single-format-standard">
	<div id="container" class="hfeed">
	<div id="header">
		<div id="masthead">
						<div style="float:left;">
																						<h3><a href="../index.html">LUDEP</a></h3>
													<div class="description">Leading Units &amp; Drone Enabled Probing</div>
												</div>
			<div class="clear"></div>
		</div>
					<div id="access">
				<div class="menu"><ul>
<li class="page_item page-item-6"><a href="../index.html">Home</a></li>
<li class="page_item page-item-9 current_page_parent"><a href="../blog/index.html">Blog</a></li>
<li class="page_item page-item-47"><a href="../project/index.html">The project</a></li>
<li class="page_item page-item-50"><a href="../links-downloads/index.html">Links &#038; Downloads</a></li>
<li class="page_item page-item-30"><a href="../about/index.html">About</a></li>
</ul></div>
				<div class="clear"></div>
			</div>
				<div class="clear"></div>
	</div>
		<div class="sidebar">
					</div>


<!-- end header --><div id="wrapper">
	<div id="content-wrapper">
		<div id="content" role="main">

		<div id="postpath">
			<a title="Goto homepage" href="../index.html">Home</a>
			 &raquo; <a href="../category/drone/index.html">Drone</a>, <a href="../category/issues/index.html">Issues</a>, <a href="../category/programming/index.html">Programming</a>, <a href="../category/testing/index.html">Testing</a>			&raquo; Performing simple image analysis and full PID controller with the Drone		</div>


	<!--div class="post"-->
	<div id="post-586" class="post post-586 type-post status-publish format-standard has-post-thumbnail hentry category-drone category-issues category-programming category-testing">
		 <h1>Performing simple image analysis and full PID controller with the Drone</h1>
					<table class="info entry-meta">
				<tr>
					<td class="date">June 10, 2011</td>
					<td>
													<span class="postedby">
								Posted by <a href="http://michael/" title="Visit Michael&#8217;s website" rel="author external">Michael</a>
							</span>
								<span class="filledunder">under</span>
												<span class="filledunder">
							<a href="../category/drone/index.html" rel="category tag">Drone</a>, <a href="../category/issues/index.html" rel="category tag">Issues</a>, <a href="../category/programming/index.html" rel="category tag">Programming</a>, <a href="../category/testing/index.html" rel="category tag">Testing</a>						</span>
					</td>
											<td>


							<div class="act">
																	<span class="comments">Comments off</span>
																							</div>
						</td>

				</tr>
			</table>

		<div class="content">
			<div style="float:right;padding: 0 0 10px 10px" class="interactive_right"><iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.html?url=http%3A%2F%2Fwww.ludep.com%2Fperforming-simple-image-analysis-and-full-pid-controller-with-the-drone%2F&amp;text=Performing%20simple%20image%20analysis%20and%20full%20PID%20controller%20with%20the%20Drone&amp;count=vertical&amp;lang=" style="width:65px; height:65px;"></iframe><iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.ludep.com%2Fperforming-simple-image-analysis-and-full-pid-controller-with-the-drone%2F&amp;layout=box_count&amp;show_faces=false&amp;width=65&amp;action=like&amp;font=arial&amp;colorscheme=light&amp;height=65" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:65px; height:65px;" allowTransparency="true"></iframe></div><p style="text-align: justify;">So far, we have been able to detect roundels on the floor with the drone by using an already existing embedded function. We have even managed to conceive a basic proportional controller (P) on the drone to track the detected roundel. Now, we have added more flexibility by using our own detection algorithm to track our own patterns freely, on top of having greatly improved our tracking control loop with a full Proportional, Derivative, Integrative (PID) control. Altitude is also managed by a simpler PI control.</p>
<h2 style="text-align: justify;">Detecting circles with OpenCV</h2>
<h3 style="text-align: justify;">Why image analysis ?</h3>
<p style="text-align: justify;">The algorithm for roundel detection developed by the engineers at Parrot was working well for achieving its immediate purpose, but this was not satisfying for us in many ways:</p>
<ul>
<li style="text-align: justify;">We have no control over its implementation. Since it is embedded on the drone firmware and we don&#8217;t have access to it, we are not able to change even a small part of it. Moreover, this function may disappear at any time in later firmware updates.</li>
<li style="text-align: justify;">We cannot decide the shape it recognizes. This is especially annoying for us, since we would like to detect different robots and identify them as such, preferably with an orientation (the pre-existing function can detect the direction of a stripped roundel, but not its orientation).</li>
<li style="text-align: justify;">Doing the image analysis on a separate computer provides us with more computing power than what is possible with the drone alone. Thus we may theoretically achieve a more efficient pattern recognition. We stay however careful about this assumption, since the delay induced by the WiFi communication and the other navigation data transfer may counterbalance this positive effect. Plus, we are beginners with OpenCV image analysis in real-time.</li>
</ul>
<h3 style="text-align: justify;">Starting with OpenCV</h3>
<p style="text-align: justify;">OpenCV seemed to be the natural way of doing our own video analysis: it is open source, greatly supported by developers and big companies such as Intel, the library has more than 500 optimized algorithms that do not need to be reinvented, it has been primarily developed for a C++ use, and so on.</p>
<p style="text-align: justify;">To first get accustomed with OpenCV and video analysis, we decided to replicate what the algorithm we have used until now is able to do. And for that matter, since we work for the moment in an environment we know, that the drone and robots are probing, we kept things simple by just <strong>detecting circles on the video stream</strong>. Our floor is indeed perfectly flat and made of only one color, without any pattern. An efficient algorithm to perform that is explained by Robert Laganière in one of his books<sup><a href="#footnote_0_586" id="identifier_0_586" class="footnote-link footnote-identifier-link" title="OpenCV 2 Computer Vision Application Programming Cookbook (Paperback) by Robert Laganiere, Packt Publishing Limited - ISBN 13: 9781849513241 ISBN 10: 1849513244">1</a></sup>.</p>
<p style="text-align: justify;">Basically, for each new frame send by the drone to the computer, we apply a Gaussian blur filter to smooth the image and avoid detecting false circles because of the noise. We then use a Canny detection<sup><a href="#footnote_1_586" id="identifier_1_586" class="footnote-link footnote-identifier-link" title="Edge detection algorithm by John F. Canny, explained on Wikipedia: http://en.wikipedia.org/wiki/Canny_edge_detector">2</a></sup> and a Hough transform<sup><a href="#footnote_2_586" id="identifier_2_586" class="footnote-link footnote-identifier-link" title="Feature extraction technique, explained on Wikipedia: http://en.wikipedia.org/wiki/Hough_transform">3</a></sup> that are regrouped in one function call, that need to have a one channel image as an input. That is why we need to first convert the color frame into an image represented by shades of gray:</p>
<pre>cv::GaussianBlur(bottomMat, bottomMat, cv::Size(5,5),1.5); <span style="color: #3366ff;">//bottomMat is the matrix of the frame we analyse</span>
cv::cvtColor(bottomMat, bottomMatDraw, CV_BGR2GRAY); <span style="color: #3366ff;">// convert 3-channel image to 1-channel gray image</span>
cv::equalizeHist(bottomMatDraw, bottomMatDraw); <span style="color: #3366ff;">// Equalize the histogram on this matrix to improve contrast; </span>
<span style="color: #3366ff;">//may not be necessary, depending on lighting conditions</span>
cv::HoughCircles(bottomMatDraw,         <span style="color: #3366ff;">// Frame to be analysed</span>
            	circles, 		<span style="color: #3366ff;">// Vector returned containing detected circles parameters</span>
            	CV_HOUGH_GRADIENT,      <span style="color: #3366ff;">// Two-pass circle detection method</span>
            	2, 			<span style="color: #3366ff;">// Accumulator resolution (image size / 2)</span>
            	50, 			<span style="color: #3366ff;">// Min. distance between two circles</span>
            	200, 			<span style="color: #3366ff;">// Canny high threshold (low thresh. = high / 2)</span>
            	75, 			<span style="color: #3366ff;">// Minimum number of votes to pass to consider a new candidate as valid</span>
            	5, 75); 		<span style="color: #3366ff;">// Min and max radius for circles to detect</span></pre>
<p>&nbsp;</p>
<h3>Results</h3>
<table class="aligncenter" width="800" align="center">
<tbody>
<tr>
<td width="400" valign="center" style="vertical-align: middle;"><a href="../wp-content/uploads/2011/06/roundelTracking2.png"><img class="size-medium wp-image-587" title="roundelTracking" src="../wp-content/uploads/2011/06/roundelTracking2.png" alt="" width="400" height="248" align="center" srcset="../wp-content/uploads/2011/06/roundelTracking2.png 980w, ../wp-content/uploads/2011/06/roundelTracking2-300x186.png 300w, ../wp-content/uploads/2011/06/roundelTracking2-100x62.png 100w" sizes="(max-width: 400px) 100vw, 400px" /></a></td>
<td><object width="400" height="320" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="src" value="https://www.youtube.com/v/EeXDYHnXCbA?version=3&amp;hl=en_US" /><param name="allowfullscreen" value="true" /><embed width="425" height="349" type="application/x-shockwave-flash" src="https://www.youtube.com/v/EeXDYHnXCbA?version=3&amp;hl=en_US" allowFullScreen="true" allowscriptaccess="always" allowfullscreen="true" /></object></td>
</tr>
<tr>
<th>Example of the roundel detection performed with a streaming video. Bottom left: Circles are drawn on top of the actual roundels. Top left: position of the roundel as detected by the Parrot embedded algorithm. Top right: front view of the drone, overlapped by the bottom view (disabled here).</th>
<th>Video showing how the recognition performs in real-time. The drone is voluntarily shaken to test the efficiency and the speed of the image analysis, that is actually fast and accurate enough, despite varying heights and non-steady rolling from side to side.</th>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p style="text-align: justify;">The algorithm proved to be eventually efficient: on average, we detect even more circles than with the embedded algorithm. The good refreshing frequency of the vertical camera is really helpful for such detection (60 frames per second) &#8211; even if we don&#8217;t get all of the frames over the WiFi connection. Yet, its biggest drawback lays in its poor resolution: we have to deal with a CMOS sensor that has a QCIF <strong>resolution of 176*144 pixels</strong>. Our recent experiments show that this is going to be a major issue while dealing with more than one robot on the ground.</p>
<p style="text-align: justify;">And we have another practical concern: it is well possible to detect our robot and keep track of it at a height of around 180 cm &#8211; but we may certainly need more than that for many robots at the same time. Our ceiling (less than 3 meters high) will be an inconvenient limitation regarding this issue.</p>
<p style="text-align: justify;">A next step will be to detect different kinds of <strong>oriented </strong>patterns at the same time. That will involve more elaborated algorithms and will require more computing resources.</p>
<h2>PID control loop</h2>
<p style="text-align: justify;">Since we now have a fairly reliable detection that reports the coordinates of a roundel (therefore a robot), we can bother with implementing a proper tracking algorithm. A feedback look using a PID seems appropriate for such a device. It is the controller used by the engineers at Parrot for managing many aspects of the drone, and it is the only kind that we really know; besides, it appears to be not to complex, and can achieve really good performances.</p>
<h3 style="text-align: justify;">How to give the quadricopter orders</h3>
<p style="text-align: justify;">The drone is controlled thanks to high-level commands that will rotate the rotors accordingly, and this is mainly done by changing four parameters:</p>
<ul style="text-align: justify;">
<li>pitch: to go forward (negative values) or backward (positive values)</li>
<li>roll: to go right (positive values) or left (negative values)</li>
<li>gaz: to go up (negative values) and down (positive values)</li>
<li>yaw: to turn right (positive values) and left (negative values)</li>
</ul>
<p style="text-align: justify;">Those values range from -25000 to +25000: the greatest they are modulus-wise, the fastest the movement will be. To track an object on the ground, the drone can stay at the same altitude (that is performed by a simple proportional and derivative controller) and does not need to turn on itself, since it can move in any direction on the same 2D plane only with pitching and rolling (yawing is mainly a good way to point the horizontal camera in a specific direction). We therefore need to concentrate solely on the <strong>pitch </strong>and <strong>roll </strong>parameters.</p>
<h3 style="text-align: justify;">Defining the PID error</h3>
<p style="text-align: justify;">While using a PID controller, one has to define what the error is. For that, we first want to describe what is the goal of our system. We want our drone to hover on top of our roundel that is detected by the vertical camera. We can therefore simplify the problem by looking at the rectangle formed by the field of view of the camera, and saying that we want our roundel located in its very center at any time. The roundel is represented by a circle thanks to our image analysis, for which we really just need the center. Basically, our problem consists in having one given point of known coordinates centered in the middle of one rectangle.</p>
<p style="text-align: justify;">The error can then be measured by looking -at the same time- at the differences between:</p>
<ul style="text-align: justify;">
<li>the <strong>x-axis</strong> coordinate of the roundel point and the x-axis coordinate of the center of the image. This is going to influence on the <strong>roll value</strong>.</li>
<li>the <strong>y-axis</strong> coordinate of the roundel point and the y-axis coordinate of the center of the image. This is going to influence on the <strong>pitch </strong>value.</li>
</ul>
<table class="aligncenter" width="500" align="center">
<tbody>
<tr>
<td><a href="../wp-content/uploads/2011/06/PID_tracking_schematic.png"><img class="aligncenter size-medium wp-image-618" title="PID_tracking_schematic" src="../wp-content/uploads/2011/06/PID_tracking_schematic.png" alt="" width="500" height="407" srcset="../wp-content/uploads/2011/06/PID_tracking_schematic.png 807w, ../wp-content/uploads/2011/06/PID_tracking_schematic-300x244.png 300w, ../wp-content/uploads/2011/06/PID_tracking_schematic-100x81.png 100w" sizes="(max-width: 500px) 100vw, 500px" /></a></td>
</tr>
<tr>
<th>This is how is calculated the error for the PID controller. We compute an error on each axis, apply the PID algorithm on both of them separately, and give the orders to activate the pitch and roll movement accordingly. Hence a unique movement that is the result of the composition of two different actions. Note that the arrows do mean that <strong>the roundel moves relatively to the camera</strong>;<strong> in fact</strong>, the result of the PID control is that <strong>the camera moves towards the roundel</strong>.</th>
</tr>
</tbody>
</table>
<p style="text-align: justify;">This boils down to having two PID controllers that yet keep the same gains parameters, since nothing is different in both cases except the orientation (same motors, same sensor, symmetric goal). Each of them has however its own error tracking and proportional, integral and derivative values evolving through time. Once this has been established, the PID implementation is straightforward, as described by J. Sluka<sup><a href="#footnote_3_586" id="identifier_3_586" class="footnote-link footnote-identifier-link" title="A PID Controller For Lego Mindstorms Robots, by J. Sluka: http://www.inpharmix.com/jps/PID_Controller_For_Lego_Mindstorms_Robots.html">4</a></sup>, who provides a very good description of its purpose, its tuning and an easy to understand pseudo-code. We do not write our code right here, since there are plenty of examples of what we did on the web, and the nearest one can be found on Sluka&#8217;s webpage.</p>
<h3 style="text-align: justify;">Tuning the PID and first tests</h3>
<p style="text-align: justify;">The hardest part in implementing a PID feedback loop is to correctly tune the three gain parameters: Kp, Ki and Kd. They greatly depend on the device used, and may even change between two robots with the same characteristics. A not too hard method to find a fair approximation of those gains values is the Ziegler-Nichols heuristic method<sup><a href="#footnote_4_586" id="identifier_4_586" class="footnote-link footnote-identifier-link" title="Ziegler-Nichols heuristic method, explained on Wikipedia: http://en.wikipedia.org/wiki/Ziegler%E2%80%93Nichols_method">5</a></sup>. But even after that, some more tuning is still needed, and we don&#8217;t have the hardware or software that could help us in that matter.</p>
<table class="aligncenter" width="600">
<tbody>
<tr>
<td><a href="../wp-content/uploads/2011/06/PID_variables_graph.png"><img class="aligncenter size-medium wp-image-626" title="PID_variables_graph" src="../wp-content/uploads/2011/06/PID_variables_graph.png" alt="" width="600" height="274" srcset="../wp-content/uploads/2011/06/PID_variables_graph.png 1366w, ../wp-content/uploads/2011/06/PID_variables_graph-300x137.png 300w, ../wp-content/uploads/2011/06/PID_variables_graph-1024x467.png 1024w, ../wp-content/uploads/2011/06/PID_variables_graph-100x45.png 100w" sizes="(max-width: 600px) 100vw, 600px" /></a></td>
</tr>
<tr>
<th>In order to ease the tuning, we kept track of all variables during the running time. Here, gain parameters are still not perfect, yet they are good enough to have a estimation of the oscillation period Pc on both<strong> x and y axis</strong> <em>(movements represented in blue and red)</em>, which has to be measured to use the Ziegler-Nichols method. Reducing the oscillation is usually made by increasing the proportional term Kp. Note also that the PI control for the altitude <em>(in green)</em> already does a good job.</th>
</tr>
</tbody>
</table>
<p style="text-align: justify;">To tune it faster, we made it possible to change each gain parameter in real-time with the XBox controller. The results are pretty convincing so far, and we were able to follow our omniwheel robot in our office over 4 meters (we lack the necessary space to test it quickly on greater distances). However, it has to be known that some conditions need to be respected in order to have a good result, for the moment at least:</p>
<ul>
<li style="text-align: justify;">no obstacles should be present around the field where both devices are moving. If a sharp difference in height is detected on the ground, the PI controller for the altitude will react quickly and the drone will suddenly go up or done to correct its altitude. This is efficient in a way, since it is working well and as expected, but is remains a problem in an enclosed room like ours, since the UAV can be stuck to the ceiling, and then lose its target.</li>
<li style="text-align: justify;">the robot shall not move too fast, otherwise the drone will lose its sight.</li>
<li style="text-align: justify;">the environment has to be correctly lighted, otherwise the image analysis may prove fail from time to time. We do not need a bright light or even a uniform light over all the surroundings, but we do at least need some light to be shed from the ceiling for instance (or the sun in an outside setting).</li>
<li style="text-align: justify;">the floor shall not be made of any pattern -at least, no circular one-, because of our own specific image analysis. This shall be addressed later.</li>
</ul>
<table class="aligncenter" width="425" align="center">
<tbody>
<tr>
<td><object width="425" height="349" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="src" value="https://www.youtube.com/v/q2vN9DEwf6k?version=3&amp;hl=en_US" /><param name="allowfullscreen" value="true" /><embed width="425" height="349" type="application/x-shockwave-flash" src="https://www.youtube.com/v/q2vN9DEwf6k?version=3&amp;hl=en_US" allowFullScreen="true" allowscriptaccess="always" allowfullscreen="true" /></object></td>
</tr>
<tr>
<th>Our actual progress in action. This time, everything is performed by our own algorithms, for both the drone and the omniwheel. For the record, here the gains are : Kp = 21, Ki = 1, Kd = 83. Oh, by the way, nobody was hurt in the making of this video: at the end, you can actually see me taking control of the drone just before fulfilling a safe landing.</th>
</tr>
</tbody>
</table>
<p style="text-align: justify;">
<h3 style="text-align: justify;">Going on&#8230;</h3>
<p style="text-align: justify;">Our next short-term goals are therefore to tune better the PID gains (Kp, Ki and Kd) in order to assure more stability while hovering over the roundel. Furthermore, we are willing to switch to a polar coordinate representation of what is seen by the drone, that should add clarity and consistency to our PID algorithm.</p>
<p>&nbsp;<br />
<b>References</b></p>
<ol class="footnotes">
<li id="footnote_0_586" class="footnote"><em>OpenCV 2 Computer Vision Application Programming Cookbook</em> (Paperback) by Robert Laganiere, Packt Publishing Limited &#8211;<strong> ISBN 13</strong>: 9781849513241 <strong>ISBN 10</strong>: 1849513244 [<a href="#identifier_0_586" class="footnote-link footnote-back-link">&#8617;</a>]</li>
<li id="footnote_1_586" class="footnote">Edge detection algorithm by John F. Canny, explained on Wikipedia: <a href="http://en.wikipedia.org/wiki/Canny_edge_detector" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://en.wikipedia.org/wiki/Canny_edge_detector', 'http://en.wikipedia.org/wiki/Canny_edge_detector');">http://en.wikipedia.org/wiki/Canny_edge_detector</a> [<a href="#identifier_1_586" class="footnote-link footnote-back-link">&#8617;</a>]</li>
<li id="footnote_2_586" class="footnote">Feature extraction technique, explained on Wikipedia: <a href="http://en.wikipedia.org/wiki/Hough_transform" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://en.wikipedia.org/wiki/Hough_transform', 'http://en.wikipedia.org/wiki/Hough_transform');">http://en.wikipedia.org/wiki/Hough_transform</a> [<a href="#identifier_2_586" class="footnote-link footnote-back-link">&#8617;</a>]</li>
<li id="footnote_3_586" class="footnote">A PID Controller For Lego Mindstorms Robots, by J. Sluka: <a href="http://www.inpharmix.com/jps/PID_Controller_For_Lego_Mindstorms_Robots.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.inpharmix.com/jps/PID_Controller_For_Lego_Mindstorms_Robots.html', 'http://www.inpharmix.com/jps/PID_Controller_For_Lego_Mindstorms_Robots.html');">http://www.inpharmix.com/jps/PID_Controller_For_Lego_Mindstorms_Robots.html</a> [<a href="#identifier_3_586" class="footnote-link footnote-back-link">&#8617;</a>]</li>
<li id="footnote_4_586" class="footnote">Ziegler-Nichols heuristic method, explained on Wikipedia: http://en.wikipedia.org/wiki/Ziegler%E2%80%93Nichols_method [<a href="#identifier_4_586" class="footnote-link footnote-back-link">&#8617;</a>]</li>
</ol>
<div class='shareaholic-canvas' data-app-id='17416092' data-app='share_buttons' data-title='Performing simple image analysis and full PID controller with the Drone' data-link='http://www.ludep.com/performing-simple-image-analysis-and-full-pid-controller-with-the-drone/' data-summary=''></div><div class='shareaholic-canvas' data-app-id='17416100' data-app='recommendations' data-title='Performing simple image analysis and full PID controller with the Drone' data-link='http://www.ludep.com/performing-simple-image-analysis-and-full-pid-controller-with-the-drone/' data-summary=''></div>			<div class="clear"></div>
			<div class="postpages">
							</div>
							<div class="under">
										<div class="clear"></div>
				</div>
					</div>

	</div>

			<div id="comments">


	<p class="nocomments">Comments are closed.</p>



</div><!-- #comments -->
	<div id="postnavi" class="navigation">
		<div class="nav prev left"><a href="../some-steps-further-with-the-omnidirectional-robot/index.html" rel="next">&laquo;  Some steps further with the omnidirectional robot</a></div>
		<div class="nav next right"><a href="../improving-the-omnidirectional-robot-design/index.html" rel="prev"> Improving the omnidirectional robot design &raquo;</a></div>
		<div class="fixed"></div>
	</div>


		</div>
	</div>
</div>


<div class="clear"></div>
<div id="outer-footer">
<div id="footer">

<div id="blue-footer">
	<div class="footer-column">

	</div>
</div>
<div class="clear"></div>
</div> <!-- footer -->
</div> <!-- outer-footer -->
<div id="copyright" style="margin:5px; text-align:center; float:left;">
<b>LUDEP</b> powered by <a href="http://wordpress.org/">WordPress</a> and
<a href="http://vatuma.com/">The Clear Line Theme</a><br/><br/>
</div>
<div style="float:right;">
	<div id="follow-widget-3" style="float:left;"><ul class="followwrap size24 row"><li class="icon_text"><a rel="nofollow me" target="_blank"  style="background: transparent url(../wp-content/plugins/share-and-follow/default/24/facebook.png) no-repeat top left;padding-left:28px;line-height:28px;" class="facebook" href="https://www.facebook.com/pages/Ludep/205635196128367" title="Become a fan"><span class="head">Become a fan</span></a></li><li class="icon_text"><a rel="nofollow me" target="_blank"  style="background: transparent url(../wp-content/plugins/share-and-follow/default/24/rss.png) no-repeat top left;padding-left:28px;line-height:28px;" class="rss" href="../feed/atom/index.html" title="RSS/Atom feed"><span class="head">RSS/Atom feed</span></a></li><li class="icon_text"><a rel="nofollow me" target="_blank"  style="background: transparent url(../wp-content/plugins/share-and-follow/default/24/twitter.png) no-repeat top left;padding-left:28px;line-height:28px;" class="twitter" href="http://www.twitter.com/LUDEPdotCOM" title="Follow us"><span class="head">Follow us</span></a></li><li class="icon_text"><a rel="nofollow me" target="_blank"  style="background: transparent url(../wp-content/plugins/share-and-follow/default/24/youtube.png) no-repeat top left;padding-left:28px;line-height:28px;" class="youtube" href="http://www.youtube.com/LUDEPdotCOM" title="Youtube channel"><span class="head">Youtube channel</span></a></li></ul><div class="clean"></div> </div>	<div class="clear"></div>
</div>
<div class="clear"></div>
	<input type="hidden" id="social_connect_login_form_uri" value="http://www.ludep.com/wp-login.php" />
	<script type='text/javascript' src='../wp-includes/js/comment-reply.min9738.js?ver=5.1.8'></script>
<script type='text/javascript' src='../wp-includes/js/wp-embed.min9738.js?ver=5.1.8'></script>

		</div> <!--container -->
</body>

<!-- Mirrored from www.ludep.com/performing-simple-image-analysis-and-full-pid-controller-with-the-drone/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 15 Mar 2021 00:49:17 GMT -->
</html>
